<div data-ng-init="init()">

    <h2 ng-if="editPage">{{dictionary.dict_name}} - Edit entry</h2>
    <h2 ng-if="!editPage">{{dictionary.dict_name}} - Create new entry</h2>

    <form class="form-horizontal newEntry" name="newEntryForm" novalidate>
        <div class="form-group" ng-repeat="(key,value) in dictionary.schema" ng-include="'container_renderer.html'" onload="parent=$parent.$parent">
        </div>
        <div class="row">
            <div class="text-right">
                <a ng-href="" class="btn btn-default">Preview</a>
                <button ng-if="!editPage" ng-click="saveEntry($event)" type="submit" class="btn btn-success">Create entry</button>
                <button ng-if="editPage" ng-click="saveEntry($event)" type="submit" class="btn btn-info">Edit entry</button>
            </div>
        </div>
    </form>

    <script type="text/ng-template" id="container_renderer.html">
        <div class="row cont" ng-if="value.type == 'container'">
            <label class="col-sm-1 control-label">{{value.label}}</label>
            <div class="form-group col-sm-11 pull-right" ng-repeat="(key,value) in value.containers" ng-include="'container_renderer.html'">
            </div>
        </div>
        <div class="row" ng-if="value.type != 'container'">
            <ng-form name="innerForm">
                <label for="{{value.element}}" class="col-sm-2 control-label">
                    <div ng-if="value.multiple == true" class="btn-group">
                        <a class="btn btn-xs btn-info" ng-click="addContainerEntry(newEntry[value.element].value, value.type)"><i class="fa fa-plus" aria-hidden="true"></i></a>
                    </div>
                    {{value.label}}<span ng-if="value.required">*</span> :
                </label>
                <div class="col-sm-10" ng-class="{'has-error': innerForm.foo.$error.required}" ng-if="value.type == 'select'">
                        <select ng-if="value.multiple != true" name="foo" ng-model="newEntry[value.element].value" id="{{value.element}}" class="form-control" ng-required="value.required">
                            <option style="display:none" value="">Select {{value.label}} . . .</option>
                            <option ng-repeat="option in value.options" value="{{option}}">{{option}}</option>
                        </select>
                        <select ng-if="value.multiple == true && newEntry[value.element].value.length <= 1" name="foo" ng-model="newEntry[value.element].value[0]" id="{{value.element}}" class="form-control" ng-required="value.required">
                            <option style="display:none" value="">Select {{value.label}} . . .</option>
                            <option ng-repeat="option in value.options" value="{{option}}">{{option}}</option>
                        </select>
                        <div class="input-group" ng-if="value.multiple == true && newEntry[value.element].value.length > 1" ng-repeat="val in newEntry[value.element].value track by $index">
                            <select name="foo" ng-model="newEntry[value.element].value[$index]" id="{{value.element}}" class="form-control" ng-required="value.required">
                                <option style="display:none" value="">Select {{value.label}} . . .</option>
                                <option ng-repeat="option in value.options" value="{{option}}">{{option}}</option>
                            </select>
                            <span class="input-group-btn">
                                <a class="btn btn-warning" ng-click="removeContainerEntry(newEntry[value.element].value, $index)"><i class="fa fa-minus" aria-hidden="true"></i></a>
                            </span>
                        </div>
                </div>
                <div class="col-sm-10" ng-class="{'has-error': innerForm.foo.$error.required}" ng-if="value.type == 'textarea'">
                        <textarea ng-if="value.multiple != true" rows="3" ng-model="newEntry[value.element].value" class="form-control" name="foo" id="{{value.element}}" ng-required="value.required"> </textarea>
                        <textarea ng-if="value.multiple == true && newEntry[value.element].value.length <= 1" rows="3" ng-model="newEntry[value.element].value[0]" name="foo" class="form-control" id="{{value.element}}" ng-required="value.required"> </textarea>
                        <div class="input-group" ng-if="value.multiple == true && newEntry[value.element].value.length > 1" ng-repeat="val in newEntry[value.element].value track by $index">
                            <textarea rows="2" ng-model="newEntry[value.element].value[$index]" name="foo" class="form-control" id="{{value.element}}" ng-required="value.required"> </textarea>
                            <span class="input-group-btn">
                                <a class="btn btn-warning" ng-click="removeContainerEntry(newEntry[value.element].value, $index)"><i class="fa fa-minus" aria-hidden="true"></i></a>
                            </span>
                        </div>
                </div>
                <div class="col-sm-10" ng-class="{'has-error': innerForm.foo.$error.required}" ng-if="value.type != 'select' && value.type != 'textarea'">
                    <input ng-if="value.multiple != true && value.type == 'file'" type="file" ng-file-model="newEntry[value.element].value" name="foo" class="form-control" id="{{value.element}}" ng-required="value.required">
                    <input ng-if="value.multiple != true && value.type != 'file'" type="{{value.type}}" name="foo" ng-model="newEntry[value.element].value" class="form-control" id="{{value.element}}" ng-required="value.required">
                    <input ng-if="value.multiple == true && (newEntry[value.element].value.length <= 1) && value.type == 'file'" type="{{value.type}}" name="foo" ng-file-model="newEntry[value.element].value[0]" class="form-control" id="{{value.element}}" ng-required="value.required">
                    <input ng-if="value.multiple == true && (newEntry[value.element].value.length <= 1) && value.type != 'file'" type="{{value.type}}" name="foo" ng-model="newEntry[value.element].value[0]" class="form-control" id="{{value.element}}" ng-required="value.required">
                    <div class="input-group" ng-if="value.multiple == true && newEntry[value.element].value.length > 1" ng-repeat="val in newEntry[value.element].value track by $index">
                        <input ng-if="value.type == 'file'" type="{{value.type}}" ng-file-model="newEntry[value.element].value[$index]" name="foo" class="form-control" id="{{value.element}}" ng-required="value.required">
                        <input ng-if="value.type != 'file'" type="{{value.type}}" ng-model="newEntry[value.element].value[$index]" name="foo" class="form-control" id="{{value.element}}" ng-required="value.required">
                        <span class="input-group-btn">
                            <a class="btn btn-warning" ng-click="removeContainerEntry(newEntry[value.element].value, $index)"><i class="fa fa-minus" aria-hidden="true"></i></a>
                        </span>
                    </div>
                </div>
            </ng-form>
        </div>

    </script>

</div>
